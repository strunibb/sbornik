<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Сборник лучших песен</title>

  <!-- Tailwind + Icons + Fonts -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary:#7c3aed;--secondary:#22d3ee;--accent:#f472b6;
      --dark:#0a0f1f;--darker:#070a16;--light:#e5e7eb
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html{scroll-behavior:smooth}
    body{
      margin:0;color:var(--light);font-family:'Poppins',sans-serif;line-height:1.6;overflow-x:hidden;
      min-height:100vh;overscroll-behavior-y:contain;-webkit-tap-highlight-color:transparent;
      padding-bottom:max(16px, env(safe-area-inset-bottom));
      background:
        radial-gradient(1100px 700px at 10% -10%, rgba(124,58,237,.16), transparent 60%),
        radial-gradient(900px 700px at 120% 110%, rgba(34,211,238,.12), transparent 60%),
        radial-gradient(800px 600px at 20% 120%, rgba(244,114,182,.10), transparent 60%),
        linear-gradient(160deg, var(--darker) 0%, var(--dark) 100%);
      position:relative;
      isolation:isolate;
    }
    /* animated blobs */
    .bg-blob{position:absolute;inset:auto;pointer-events:none;filter:blur(40px);opacity:.5;mix-blend:screen;animation:float 24s ease-in-out infinite}
    .bg-blob.one{top:-90px;left:-80px;width:320px;height:320px;background:radial-gradient(circle,#7c3aed 0%, transparent 70%)}
    .bg-blob.two{right:-120px;bottom:-120px;width:380px;height:380px;background:radial-gradient(circle,#22d3ee 0%, transparent 70%);animation-delay:-6s}
    .bg-blob.three{left:55%;top:20%;width:300px;height:300px;background:radial-gradient(circle,#f472b6 0%, transparent 70%);animation-delay:-12s}
    @keyframes float{
      0%,100%{transform:translate3d(0,0,0)}
      50%{transform:translate3d(0,-14px,0)}
    }
    /* subtle noise */
    .noise:before{
      content:"";position:fixed;inset:0;pointer-events:none;opacity:.07;mix-blend:overlay;z-index:-1;
      background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity=".55"/></svg>');
      background-size:220px 220px;
    }

    /* header */
    .header-title{
      font-family:'Montserrat',sans-serif;font-weight:800;letter-spacing:.2px;
      font-size:clamp(2.2rem,5vw,3.6rem);
      background:linear-gradient(90deg,#f472b6,#7c3aed,#22d3ee);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      text-shadow:0 10px 30px rgba(124,58,237,.25);
      background-size:200% 100%;animation:gradientShift 10s ease-in-out infinite;
    }
    @keyframes gradientShift{
      0%{background-position:0% 50%}
      50%{background-position:100% 50%}
      100%{background-position:0% 50%}
    }

    /* glass */
    .glass{background:rgba(10,15,31,.55);border:1px solid rgba(124,58,237,.18);backdrop-filter:blur(12px)}
    .glass-strong{background:rgba(10,15,31,.72);border:1px solid rgba(124,58,237,.28);backdrop-filter:blur(16px)}

    /* song cards */
    .song-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px}
    .song-item{
      border:1px solid rgba(124,58,237,.18);background:rgba(10,15,31,.66);backdrop-filter:blur(8px);
      border-radius:18px;padding:14px;cursor:pointer;transition:.25s;position:relative;overflow:hidden
    }
    .song-item:after{
      content:"";position:absolute;inset:auto 0 0;height:3px;background:linear-gradient(90deg,#7c3aed,#22d3ee,#f472b6);
      opacity:0;transition:.25s;transform:translateY(2px)
    }
    .song-item:hover{transform:translateY(-3px);border-color:rgba(124,58,237,.6);box-shadow:0 12px 24px -8px rgba(124,58,237,.35)}
    .song-item:hover:after{opacity:.9;transform:none}
    .song-item.selected{
      border-color:#7c3aed;box-shadow:0 0 24px rgba(124,58,237,.55) inset, 0 12px 30px -10px rgba(124,58,237,.35);
      background:linear-gradient(135deg, rgba(124,58,237,.16), rgba(34,211,238,.12))
    }
    .song-title{font-family:'Montserrat',sans-serif;font-weight:700;font-size:1rem;line-height:1.25;word-break:break-word}
    .song-artist{font-size:.92rem;color:#bfdbfe;word-break:break-word}
    .tile-icon{width:46px;height:46px;border-radius:14px;display:flex;align-items:center;justify-content:center;background:rgba(124,58,237,.16);transition:.25s}
    .song-item:hover .tile-icon{transform:rotate(4deg) scale(1.05);background:rgba(124,58,237,.26)}

    /* search */
    .search-box{width:100%;background:rgba(16,23,42,.7);border:1px solid rgba(124,58,237,.25);color:#fff;padding:16px 56px;border-radius:14px}
    .search-box:focus{outline:none;border-color:var(--secondary);box-shadow:0 0 0 4px rgba(34,211,238,.22)}
    .search-icon{position:absolute;left:16px;top:50%;transform:translateY(-50%);color:#94a3b8}
    .clear-search{position:absolute;right:14px;top:50%;transform:translateY(-50%);color:#94a3b8;cursor:pointer}
    .highlight{background:rgba(244,114,182,.35);border-radius:4px;padding:0 2px}

    /* chips */
    .chip{
      background:linear-gradient(180deg,rgba(124,58,237,.18),rgba(15,23,42,.6));
      border:1px solid rgba(124,58,237,.35);
      border-radius:999px;padding:10px 14px;white-space:nowrap;cursor:pointer;transition:.2s;
      box-shadow:inset 0 0 24px rgba(124,58,237,.18);
      font-size:.95rem
    }
    .chip:hover{transform:translateY(-1px);filter:saturate(1.05)}
    .chip.active{border-color:#fff;box-shadow:0 0 0 2px rgba(255,255,255,.25), inset 0 0 24px rgba(34,211,238,.35)}
    .chips-wrap{overflow:auto;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch}
    .chips-wrap::-webkit-scrollbar{height:8px}
    .chips-wrap::-webkit-scrollbar-thumb{background:rgba(148,163,184,.35);border-radius:999px}

    /* buttons */
    .btn{display:inline-flex;align-items:center;gap:.55rem;border-radius:14px;padding:12px 16px;font-weight:700;transition:.2s;user-select:none}
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:linear-gradient(90deg,#7c3aed,#22d3ee);border:1px solid rgba(124,58,237,.45);color:#fff;box-shadow:0 10px 24px rgba(124,58,237,.28)}
    .btn-primary:hover{filter:saturate(1.1)}
    .btn-ghost{background:rgba(16,23,42,.7);border:1px solid rgba(124,58,237,.28);color:#e5e7eb}
    .btn-ghost:hover{background:rgba(16,23,42,.85)}
    .btn-danger{background:rgba(239,68,68,.18);border:1px solid rgba(239,68,68,.35);color:#fecaca}
    .btn-danger:hover{background:rgba(239,68,68,.26)}

    /* floating buttons */
    #toCartFloating{
      position:fixed;left:50%;transform:translateX(-50%);bottom:max(14px, env(safe-area-inset-bottom));z-index:900;display:none;
      background:linear-gradient(90deg,#7c3aed,#22d3ee,#f472b6);color:#fff;border:none;padding:14px 20px;border-radius:999px;
      box-shadow:0 14px 28px rgba(124,58,237,.35),0 0 40px rgba(34,211,238,.32);font-weight:800;letter-spacing:.2px
    }
    #toCartFloating.show{display:flex}
    .badge{
      position:absolute;top:-8px;right:-8px;background:#10b981;color:#0b1224;border-radius:999px;font-size:.75rem;padding:2px 7px;
      border:2px solid rgba(10,15,31,.9)
    }
    #toTop{
      position:fixed;right:12px;bottom:calc(max(64px, env(safe-area-inset-bottom)) + 12px);z-index:850;display:none
    }
    #toTop.show{display:block}

    /* inputs */
    .contact-input{
      width:100%;background:rgba(16,23,42,.7);border:1px solid rgba(124,58,237,.28);color:#fff;
      padding:14px 14px;border-radius:14px;transition:.2s
    }
    .contact-input:focus{outline:none;border-color:var(--secondary);box-shadow:0 0 0 3px rgba(34,211,238,.22)}

    /* toast */
    .notification{position:fixed;right:18px;bottom:24px;background:linear-gradient(90deg,#10b981,#06b6d4);color:#0a0f1f;
      padding:12px 16px;border-radius:12px;transform:translateY(140%);transition:.4s;z-index:1000;box-shadow:0 10px 24px rgba(0,0,0,.25);font-weight:700}
    .notification.show{transform:translateY(0)}

    /* reveal */
    .reveal{opacity:0;transform:translateY(10px);transition:opacity .5s ease, transform .5s ease}
    .reveal.in{opacity:1;transform:none}

    /* scroll progress */
    #scrollProgress{position:fixed;top:0;left:0;height:3px;background:linear-gradient(90deg,#7c3aed,#22d3ee,#f472b6);width:0;z-index:1000}

    @media(max-width:768px){
      .song-grid{grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
      @media (max-width:380px){
        .song-grid{grid-template-columns:repeat(1,minmax(0,1fr))}
      }
      .tile-icon{width:42px;height:42px}
      .song-title{font-size:1rem}.song-artist{font-size:.92rem}.header-title{font-size:2.1rem}
    }

    /* motion reduce */
    @media (prefers-reduced-motion: reduce) {
      .bg-blob,.header-title{animation:none}
    }
  </style>
</head>

<body class="pb-28 noise">
  <!-- animated background blobs -->
  <div class="bg-blob one"></div>
  <div class="bg-blob two"></div>
  <div class="bg-blob three"></div>
  <div id="scrollProgress"></div>

  <div class="container mx-auto px-4 max-w-7xl relative">
    <!-- HEADER -->
    <header class="pt-10 md:pt-14 mb-8 text-center">
      <div class="flex justify-center mb-6">
        <div class="glass p-4 rounded-2xl shadow-xl inline-flex">
          <!-- custom SVG icon (wave) -->
          <div class="p-4 rounded-2xl" style="background:linear-gradient(135deg,#7c3aed, #22d3ee);box-shadow:0 10px 24px rgba(124,58,237,.35)">
            <svg width="44" height="44" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path d="M6 32h8l5-20 6 40 6-26 6 18 5-12h16" stroke="white" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </div>
      </div>
      <h1 class="header-title mb-2">Сборник лучших песен</h1>
      <p class="opacity-80 max-w-2xl mx-auto">Фильтруйте по исполнителю, выбирайте треки и отправляйте заявку прямо в Telegram.</p>
    </header>

    <!-- ARTISTS FILTER (sticky) -->
    <section class="glass-strong rounded-3xl shadow-2xl p-5 md:p-6 mb-8 sticky z-30" style="top: max(6px, env(safe-area-inset-top))">
      <div class="flex items-center justify-between gap-4 flex-wrap">
        <div class="flex items-center gap-3">
          <span class="font-extrabold text-lg" style="font-family:'Montserrat',sans-serif">
            Исполнители
          </span>
          <span id="artistMeta" class="text-xs opacity-75"></span>
        </div>
        <div class="flex items-center gap-2 w-full md:w-auto">
          <div class="relative flex-1">
            <span class="search-icon"><i class="fa-solid fa-user"></i></span>
            <input id="artistSearch" class="search-box" placeholder="Быстрый поиск исполнителя…">
            <span id="artistSearchClear" class="clear-search hidden"><i class="fas fa-times"></i></span>
          </div>
          <button id="artistClear" class="btn btn-ghost"><i class="fa-solid fa-rotate-left"></i> Сбросить</button>
        </div>
      </div>
      <div id="artistChips" class="chips-wrap mt-4 flex gap-2 py-2"></div>
    </section>

    <!-- TEXT SEARCH -->
    <div class="max-w-2xl mx-auto mb-8 relative">
      <span class="search-icon"><i class="fas fa-search"></i></span>
      <input id="search-input" class="search-box" placeholder="Поиск по названию или артисту...">
      <span id="clear-search" class="clear-search hidden"><i class="fas fa-times"></i></span>
    </div>

    <!-- SONGS -->
    <section class="glass rounded-3xl shadow-2xl p-6">
      <div class="mb-6 text-center">
        <h2 class="font-extrabold text-xl md:text-2xl inline-block pb-2 relative" style="font-family:'Montserrat',sans-serif">
          Список песен
        </h2>
        <div class="mt-2 text-sm opacity-80">
          Отсортировано по артистам: А–Я, затем A–Z • Всего: <b id="totalCount">0</b> • Показано: <b id="shownCount">0</b>
        </div>
      </div>

      <div id="song-list" class="song-grid"></div>
      <div id="no-results" class="text-center opacity-80 py-8 hidden">
        <i class="fa-regular fa-face-sad-tear text-2xl mb-2"></i>
        <div>Ничего не найдено…</div>
      </div>
      <div id="sentinel" class="text-center text-sm opacity-70 py-6 hidden">Загружаем ещё…</div>
    </section>

    <!-- CART -->
    <section id="cartSection" class="glass rounded-3xl shadow-2xl p-6 mt-10 hidden border-t-4" style="border-color:#7c3aed">
      <div class="flex items-center justify-between mb-4 flex-wrap gap-3">
        <div class="flex items-center gap-3">
          <span class="chip"><i class="fa-solid fa-basket-shopping mr-1"></i> В корзине: <b id="cartCount">0</b></span>
        </div>
        <div class="flex gap-2">
          <button id="copyBtn" class="btn btn-primary"><i class="fa-regular fa-copy"></i> Скопировать</button>
          <button id="clearBtn" class="btn btn-ghost"><i class="fa-solid fa-trash"></i> Очистить</button>
        </div>
      </div>

      <div id="cartList" class="grid md:grid-cols-2 gap-3"></div>

      <!-- ORDER FORM -->
      <form id="orderForm" class="mt-8 grid md:grid-cols-2 gap-4">
        <input class="contact-input" id="buyerName" placeholder="Ваше имя"/>
        <input class="contact-input" id="buyerContact" placeholder="Контакт (Telegram @ник, телефон или WhatsApp)"/>
        <textarea class="contact-input md:col-span-2" id="buyerComment" rows="3" placeholder="Комментарий (по желанию)"></textarea>
        <button id="sendOrder" type="submit" class="btn btn-primary md:col-span-2 justify-center">
          <i class="fa-regular fa-paper-plane"></i> Отправить заявку на покупку песен
        </button>
        <div class="text-xs opacity-70 md:col-span-2">Заявка приходит в Telegram. Мы свяжемся с вами для подтверждения.</div>
      </form>
    </section>
  </div>

  <!-- Floating cart -->
  <button id="toCartFloating" class="relative">
    <i class="fa-solid fa-cart-shopping mr-2"></i>
    <span>Перейти к корзине</span>
    <span id="floatBadge" class="badge hidden">0</span>
  </button>

  <!-- Back to top -->
  <button id="toTop" class="btn btn-ghost" title="Наверх"><i class="fa-solid fa-arrow-up"></i></button>

  <!-- Toast -->
  <div id="notify" class="notification"><i class="fa-solid fa-check mr-2"></i><span></span></div>

  <script>
  // ================== RAW LIST (оставил весь ваш список) ==================
  const RAW_LIST = `
Би-2 — Мы не ангелы, парень
Бортпроводник — Давай сбежим
Бумбокс — Та что
Егор Крид — Девочка с картинки
Егор Крид — Надо ли
Женя Трофимов — Все они о тебе (feat. Комната Культуры)
Женя Трофимов — Поезда
HENSY — Замок на мостик
HENSY — Пить и курить
Ляпис Трубецкой — В платье белом
ЛСП — Бэйби
Lizer — Быстро повзрослел
Любэ — А зори здесь тихие
Любэ — Есть только миг
Любэ — От Волги до Енисея
Любэ — Позови меня тихо по имени
Любэ — Ты неси меня река
Макс Корж — Мотылёк
Монеточка — Селфхарм
Моя Мишель — Курточка
Найк Борзов — Верхом на звезде
Нервы — Её имя
Нервы — Зажигалки
Нервы — Как как надо
Нервы — Кофе — мой друг
Нервы — Слишком влюблён
Нервы — Суицид моей веры
Папин Олимпос — Школа
Песни из кино — Девчата — Старый клён
Пицца — Лифт
Порнофильмы — Я так соскучился
Просто Лера — Лютики
Пятница — Нева
Рожден Ануси — Знаешь, душа моя рваная
Руки Вверх! — Когда мы были молодыми
Руки Вверх! — Он тебя целует
Руки Вверх! — Чужие губы
Сектор Газа — Твой звонок
Сергей Лазарев — В самое сердце
Сергей Трофимов — Алёшка
Сергей Трофимов — Ветерок
Сергей Трофимов — Я скучаю по тебе
Feduk — Краски
Feduk — Хлопья летят наверх
Юлий Ким — Губы окаянные
5’nizza — Весна
5’nizza — Зима
5’nizza — Моя Ямайка
5’nizza — Стрела
5’nizza — Ты кидал
5’nizza — Я солдат
7Б — Молодые ветра
7Б — Неизвестный солдат
7Б — Осень
7Б — Последний герой
Агата Кристи — Как на войне
Агата Кристи — Сказочная тайга
Александр Розенбаум — Ау
Александр Розенбаум — Братан
Александр Розенбаум — Вальс-бостон
Александр Розенбаум — Гоп-стоп
Александр Розенбаум — Черный тюльпан
Алексин Андрей — Малолетние шалавы
Алиса — Небо славян
Амега — Лететь
Армейская песня — Здравствуй, небо в облаках
Ария — Возьми моё сердце
Ария — Встань, страх преодолей
Ария — Герой асфальта
Ария — Замкнутый круг
Ария — Осколок льда
Ария — Там высоко
Ария — Штиль
Ахра — Карие глаза
Баста — Выпускной (Медлячок)
Баста — Сансара
Баста — Темная ночь
Би-2 — Варвара
Би-2 — Мой рок-н-ролл
Би-2 — Серебро
Божья Коровка — Гранитный камушек
Браво — Ветер знает
Браво — Любите, девушки
Бременские музыканты — Ничего на свете лучше нету
Братья Грим — Ресницы
Бумбокс — Вахтерам
Бумбокс — Летний дождь
Бумбокс — Пепел
Бумбокс — Хоттабыч
Валентин Стрыкало — 92
Валентин Стрыкало — Всё решено
Валентин Стрыкало — Гори
Валентин Стрыкало — Дешёвые драмы
Валентин Стрыкало — Знаешь, Таня
Валентин Стрыкало — Наше лето
Валентин Стрыкало — Офисный стиляга
Валентин Стрыкало — Он постоянно что-то ест
Валентин Стрыкало — Песня для девочек
Валентин Стрыкало — Рустем
Валентин Стрыкало — Серёжка
Валентин Стрыкало — фанк
Валерий Кипелов — Я свободен
Виктор Цой — Каждую ночь
Виктор Цой — Город
Владимир Высоцкий — Песня о друге
Владимир Высоцкий — Песня о сентиментальном боксере
Владимир Высоцкий — Я не люблю
Градусы — Голая
Градусы — Режиссер
Гречка — Здесь были
Гречка — Люби меня
Гречка — Твои руки
Дайте танк (!) — Друг
Дайте танк (!) — Курьер
Дайте танк (!) — Маленький
Дайте танк (!) — Мы
Дайте танк (!) — Спам
Дайте танк (!) — Сюрприз
Дайте танк (!) — Утро
Dabro — Билет
Dabro — Давай запоём
Dabro — Два крыла
Dabro — Дальше — больше
Dabro — Мне не страшно
Dabro — На крыше
Dabro — На часах ноль-ноль
Dabro — Полюбил тебя
Dabro — Поцелуй
Dabro — Солнце и Луна
Dabro — Ты знаешь, мам
Dabro — Я по частицам
Dabro — Всё за одного
ДДТ — Что такое осень
Денис Майданов — Вечная любовь
Джизус — Век эвтаназии
Джизус — Открой глаза
Дора — Дорадура
Дора — Дорадура (ремикс)
Дора — ЕК
Дора — Осень пьяная
Дора — Поздно (feat. Feduk)
Евгений Белоусов — Девчонка-девчоночка
Егор Крид — Будильник
Егор Крид — Дым (feat. JONY)
Егор Крид — Если ты меня не любишь (feat. Molly)
Егор Крид — Невеста
Егор Крид — Надо ли
Егор Крид — Самая-самая
Егор Крид — Завтра
Егор Крид — Завтра (feat. Баста)
Егор Крид — Папина дочка
Женя Трофимов — Ветерок
Женя Трофимов — Голуби
Женя Трофимов — Город Сочи
Женя Трофимов — Иномарка
Женя Трофимов — Корабли
Женя Трофимов — Корабли (перебор)
Женя Трофимов — Море
Женя Трофимов — Ночь
Женя Трофимов — Первая любовь (feat. Комната Культуры)
Женя Трофимов — Привет
Женя Трофимов — Пусть она поёт
Женя Трофимов — Родина
Женя Трофимов — Самолёты
Женя Трофимов — Я скучаю по тебе
Жуки — Батарейка
Жуки — Танкист
Жуки — Влечение
Звери — Брюнетки и блондинки
Звери — Для тебя
Звери — До скорой встречи
Звери — Напитки покрепче
Звери — Районы-кварталы
Звери — Танцуй
Звери — Всё, что касается
Звери — Просто такая сильная любовь
Земляне — Трава у дома
Земфира — Аривадерчи
Земфира — Бесконечность
Земфира — В метро
Земфира — Искала
Земфира — Ромашки
Земфира — Хочешь
Иванушки International — Тополиный пух
Игорь Скляр — Комарово
IOWA — Простая песня
Канги — Эйя
Кино — Алюминиевые огурцы
Кино — Апрель
Кино — Атаман
Кино — Группа крови
Кино — Дальше, действовать будем мы
Кино — Звезда по имени Солнце
Кино — Когда твоя девушка больна
Кино — Кукушка
Кино — Красно-желтые дни
Кино — Легенда
Кино — Малыш
Кино — Мама, мы все тяжело больны
Кино — Нам с тобой
Кино — Невесёлая песня
Кино — Ночь
Кино — Пачка сигарет
Кино — Перемен
Кино — Печаль
Кино — Попробуй спеть вместе со мной
Кино — Сосны на морском берегу
Кино — Спокойная ночь
Кино — Стук
Кино — Закрой за мной дверь
Клава Кока, Hensy — Костер
Колизей — Имя твоё
Король и Шут — Внезапная голова
Король и Шут — Воспоминания о былой любви
Король и Шут — Гробовщик
Король и Шут — Два друга и разбойники
Король и Шут — Дурак и молния
Король и Шут — Ели мясо мужики
Король и Шут — Камнем по голове
Король и Шут — Кукла колдуна
Король и Шут — Лесник
Король и Шут — Маска
Король и Шут — Марионетки
Король и Шут — Мёртвый анархист
Король и Шут — На краю
Король и Шут — Отражение
Король и Шут — Помнят с горечью древляне
Король и Шут — Проклятый старый дом
Король и Шут — Прыгну со скалы
Король и Шут — Северный флот
Король и Шут — Счастье
Король и Шут — Танец злобного гения
Король и Шут — Тяни
Король и Шут — Фокусник
Круг Михаил — Девочка пай
Круг Михаил — Исповедь
Круг Михаил — Кольщик
Круг Михаил — Приходите в мой дом
Круг Михаил — Роза
Круг Михаил — Тебе моя последняя любовь
Круг Михаил — Тишина
Ласковый Май — Белые розы
Ласковый Май — Детство
Ласковый Май — Розовый вечер
Леонид Агутин — На сиреневой луне
Леонид Агутин — Хоп-хэй Ла-ла-лей
Ленинград — В Питере — пить
Ленинград — Экспонат
Lizer — Быстро повзрослел
ЛСП — Парный дурак
Любэ — Берёзы
Любэ — Конь
Любэ — Там за туманами
Любэ — Солдат
МакSим — Знаешь ли ты
Макс Корж — 2 типа людей
Макс Корж — В темноте
Макс Корж — Жить в кайф
Макс Корж — Малиновый закат
Макс Корж — Мотылёк
Макс Корж — Небо поможет нам
Макс Корж — Слово пацана
Макс Корж — Эндорфин
Мельница — Дороги
Мельница — Королева
Мираж — Музыка нас связала
Михаил Боярский — Зеленоглазое такси
Михаил Круг — Девочка пай
Михаил Круг — Фраер 2
Многоточие — Щемит в груди
Монеточка — Каждый раз
Монеточка — Нимфоманка
Монеточка — Папина любовница
Монеточка — Селфхарм
Монеточка — Запорожец
Моя Мишель — Курточка
Мумий Тролль — Девочка
Мумий Тролль — Медведица
Мумий Тролль — Утекай
Мумий Тролль — Забавы
Наутилус Помпилиус — Крылья
Наутилус Помпилиус — Одинокая птица
Наутилус Помпилиус — Прогулки по воде
Наутилус Помпилиус — Скованные одной цепью
Наутилус — Я хочу быть с тобой
Нервы — Батареи
Нервы — Да или…
Нервы — Её имя
Нервы — Как как надо
Нервы — Кофе мой друг
Нервы — Самый дорогой человек
Нервы — Счастье
Нервы — Слишком влюблён
Нервы — Суета моей веры
Нервы — Я не хочу без тебя спать
Ногу Свело! — Наши юные смешные голоса
Олег Митяев — Как здорово, что все мы здесь сегодня собрались
Олег Митяев — Изгиб гитары жёлтой
Папин Олимпос — День, когда мы все встретились с тобой
Папин Олимпос — Динозаврики
Папин Олимпос — Официантка
Папин Олимпос — Сегодня не пойду гулять
Папин Олимпос — Снежинка
Папин Олимпос — Темно-оранжевый закат
Песни из кино и мультфильмов — Девчата (Старый клён)
Песни из кино и мультфильмов — Свадьба в Малиновке
Песни из кино и мультфильмов — Бременские музыканты
Пицца — Оружие
Пицца — Романс
Пицца — Тише
Пицца — Улыбка
Пицца — Фарами
Порнофильмы — Прости, прощай, привет
Порнофильмы — Я так соскучился
Пошлая Молли — Контракт
Пошлая Молли — Любимая песня твоей сестры
Рождество — Ты знаешь, так хочется жить
Руки Вверх! — 18 мне уже
Руки Вверх! — Алешка
Руки Вверх! — Девчонка
Руки Вверх! — Когда мы были молодыми
Руки Вверх! — Крошка моя
Руки Вверх! — Он тебя целует
Руки Вверх! — Студент
Руки Вверх! — Чужие губы
Сектор Газа — 30 лет
Сектор Газа — Бомж
Сектор Газа — Казачья
Сектор Газа — Колхозный панк
Сектор Газа — Life
Сектор Газа — Лирика
Сектор Газа — Свидание
Сектор Газа — Туман
Сектор Газа — Твой звонок
Сектор Газа — Ява
Сергей Лазарев — В самое сердце
Сергей Трофимов — Голуби
Сергей Трофимов — Город Сочи
Сергей Трофимов — Иномарка
Сергей Трофимов — Московская песня
Сергей Трофимов — Родина
Сергей Трофимов — Снегири
Сергей Трофимов — Алексей
Сергей Трофимов — Привет
Сергей Трофимов — Ветерок
Сергей Трофимов — Я скучаю по тебе
Скриптонит — Вечеринка
Скриптонит — Где твоя любовь
Скриптонит — Космос
Скриптонит — Не забирай меня с пати
Скриптонит — Танцуй сама
Сплин — Двое не спят
Сплин — Орбит без сахара
Сплин — Танцуй
Стас Михайлов — Без тебя
Танцы Минус — Город
Танцы Минус — Половинка
Танцы Минус — Ю
Татьяна Куртукова — Матушка
Татьяна Куртукова — Одного
Тима Белорусских — Незабудка
Тимур Муцураев — Милые зелёные глаза
Тимур Муцураев — Твоя нежная походка
Три дня дождя — Космос
Три дня дождя — Осень и алкоголь
Три дня дождя — Отпускай
Тринадцать Карат — Во снах
Тринадцать Карат — В моей голове
Тринадцать Карат — Из-за тебя
Тринадцать Карат — Пока он тебя не бросит
Тринадцать Карат — Последний лепесток
Фактор 2 — Война
Фактор 2 — Красавица
Фактор 2 — Марихуана 3000
Фактор 2 — Шалава
Фактор 2 — Одинокая звезда
Feduk — Моряк
Feduk — Запрети мне носить AirMax
Feduk — Хлопья летят наверх
Чайф — Аргентина — Ямайка 5:0
Чайф — Бутылка кефира, полбатона
Чайф — Никто не услышит (Ой-ёй)
Чиж & Co — Фантом
Чиж — 18 берёз
Юлий Ким — Губы окаянные
Юта — Жили-были
Justin Bieber — Love Yourself
Justin Bieber — Mistletoe
Justin Bieber — Sorry
Justin Bieber — What Do You Mean
KSB Muzic — Осень
Lida — Фото со звездой
Måneskin — I Wanna Be Your Slave
MiyaGi — По уши в тебя влюблён
MiyaGi & Andy Panda — Fire Man
MiyaGi & Andy Panda — Kosandra
MiyaGi & Andy Panda — Патрон
Miyagi & Эндшпиль — Bounty
Miyagi & Эндшпиль — Фея
Miyagi & Эндшпиль feat. NERAK — Именно та
Ssshhiiittt! — Засыпай
Ssshhiiittt! — Тебя нет
Xcho — Ты и я
Xolidayboy — Кино
Xolidayboy — Мания
Xolidayboy — Мотыльки
Xolidayboy — Моя хулиганка
Xolidayboy — Мы не будем спать
Xolidayboy — Океаны
Xolidayboy — Пожары
`;

  // ================== TELEGRAM SETTINGS ==================
  const BOT_TOKEN = "7598736914:AAHVJUOt7okTfMh1VE_l1ZrCqaXv-r1PcWI";
  const CHAT_ID  = "725158536";

  // ================== UTILS + ALIASES ==================
  const $ = (s, r=document)=>r.querySelector(s);
  const $$ = (s, r=document)=>Array.from(r.querySelectorAll(s));
  const normRu = s => (s||'').toString().toLowerCase().replace(/ё/g,'е').trim();
  const asciiApos = s => (s||'').replace(/[’`]/g,"'");

  // Переименования по вашим правилам
  const ALIAS = new Map([
    ["hensy","Hensy"],
    ["круга михаил","Михаил Круг"],["круг михаил","Михаил Круг"],
    ["юля ким","Юлий Ким"],
    ["дабро (dabro)","Dabro"],["дabro","Dabro"],
    ["валерий кипелов","Ария"],
    ["виктор цой","Кино"],
    ["наутилус","Наутилус Помпилиус"],
    ["песни из кино","Песни из кино и мультфильмов"],
    ["чиж","Чиж & Co"],
    ["пятница","5'nizza"],
    ["5’nizza","5'nizza"],
    ["miyagi & эндшпиль feat. nerak","Miyagi & Эндшпиль"],
    ["miyagi & эндшпиль","Miyagi & Эндшпиль"],
    ["miyagi & andy panda","Miyagi & Эндшпиль"],
  ]);
  const DONT_SPLIT_AMP = new Set(["Miyagi & Эндшпиль","Чиж & Co"]);

  const cleanName = s => asciiApos(normRu(s)).replace(/\s+/g,' ').trim();
  const applyAlias = (name) => ALIAS.get(cleanName(name)) || name.trim();

  // Разбивка на артистов для фильтра (Клава Кока, Hensy — отдельно)
  function splitArtists(raw){
    const aliasedWhole = applyAlias(raw);
    if (DONT_SPLIT_AMP.has(aliasedWhole)) return [aliasedWhole];

    let parts = raw.split(/\s*,\s*|\s+feat\.?\s+|\s+ft\.?\s+|\s+x\s+/i);
    if (parts.length === 1 && !DONT_SPLIT_AMP.has(aliasedWhole) && /\s&\s/.test(raw)) {
      parts = raw.split(/\s&\s/);
    }
    const mapped = [...new Set(parts.map(p=>applyAlias(p)))].filter(Boolean);
    return mapped.length ? mapped : [aliasedWhole];
  }
  const canonicalArtist = (raw)=> splitArtists(raw).join(', ');

  // Парсинг
  function parseSongs(raw){
    const lines = raw.split(/\r?\n/).map(l=>l.trim()).filter(Boolean);
    const skipByPhrase = (s) => /пропуск|если есть/i.test(s) || /см\./i.test(s) || /см\s/i.test(s) || /Дукатура/i.test(s);
    const seen = new Set(), songs = [];

    for(const line of lines){
      if(!line.includes('—') || skipByPhrase(line)) continue;

      const firstDash = line.indexOf('—');
      let artist = line.slice(0, firstDash).trim();
      let title  = line.slice(firstDash+1).trim();

      title = title.replace(/\([^)]*\)/g,'').replace(/\s{2,}/g,' ').trim();
      artist = artist.replace(/\([^)]*\)/g,'').trim();
      title = title.replace(/(\d)\s*[:]\s*(\d)/g,'$1-$2'); // 5:0 -> 5-0

      const displayArtist = canonicalArtist(artist);
      const artistList = splitArtists(artist);

      const key = normRu(displayArtist)+'—'+normRu(title);
      if(seen.has(key)) continue;
      seen.add(key);

      if(!displayArtist || !title) continue;
      songs.push({artist: displayArtist, title, artists: artistList});
    }
    return songs;
  }

  const isCyr = s => /^[а-яё]/i.test(s||'');
  function sortSongs(arr){
    return arr.sort((a,b)=>{
      const aC = isCyr(a.artist), bC = isCyr(b.artist);
      if(aC!==bC) return aC? -1 : 1;
      const cmpA = a.artist.toLocaleLowerCase('ru').localeCompare(b.artist.toLocaleLowerCase('ru'),'ru');
      if(cmpA!==0) return cmpA;
      return a.title.toLocaleLowerCase('ru').localeCompare(b.title.toLocaleLowerCase('ru'),'ru');
    });
  }

  // ================== STATE/REFS ==================
  const songList = $('#song-list');
  const totalCountEl = $('#totalCount');
  const shownCountEl = $('#shownCount');
  const searchInput = $('#search-input');
  const clearSearch = $('#clear-search');
  const cartSection = $('#cartSection');
  const cartList = $('#cartList');
  const cartCount = $('#cartCount');
  const notify = $('#notify');
  const toCartFloating = $('#toCartFloating');
  const floatBadge = $('#floatBadge');
  const toTopBtn = $('#toTop');
  const sentinel = $('#sentinel');

  const artistChips = $('#artistChips');
  const artistSearch = $('#artistSearch');
  const artistSearchClear = $('#artistSearchClear');
  const artistClear = $('#artistClear');
  const artistMeta = $('#artistMeta');

  const ALL_SONGS = sortSongs(parseSongs(RAW_LIST));
  totalCountEl.textContent = ALL_SONGS.length;

  const selected = new Map();
  let q = '';
  let artistFilter = '';

  // Виртуализация
  let filteredCache = [];
  let visibleLimit = 0;
  const BATCH = 90;

  function computeFiltered(){
    const n = normRu(q);
    return ALL_SONGS.filter(s=>{
      const hitSearch = !n || normRu(s.title).includes(n) || normRu(s.artist).includes(n);
      const hitArtist = !artistFilter || s.artists.includes(artistFilter);
      return hitSearch && hitArtist;
    });
  }

  function renderChunk(start, end){
    for (let i=start;i<end;i++){
      const s = filteredCache[i]; if(!s) break;
      const card = document.createElement('div');
      card.className = 'song-item reveal';
      card.dataset.title = s.title;
      card.dataset.artist = s.artist;
      const checked = selected.has(`${s.title}::${s.artist}`) ? '<i class="fa-solid fa-check text-emerald-400"></i>' : '';
      card.innerHTML = `
        <div class="flex items-start gap-3">
          <div class="tile-icon">
            <i class="fa-solid fa-wave-square text-cyan-200"></i>
          </div>
          <div class="flex-1 min-w-0">
            <div class="song-title">${s.title}</div>
            <div class="song-artist">${s.artist}</div>
          </div>
        </div>
        <div class="absolute right-2 top-2 opacity-90">${checked}</div>
      `;
      card.addEventListener('click', ()=>toggleSelect(card));
      songList.appendChild(card);
    }
  }

  function renderSongs(){
    songList.innerHTML = '';
    filteredCache = computeFiltered();
    visibleLimit = Math.min(BATCH, filteredCache.length);
    renderChunk(0, visibleLimit);

    $('#no-results').classList.toggle('hidden', filteredCache.length>0);
    shownCountEl.textContent = Math.min(visibleLimit, filteredCache.length);

    // Highlight
    const nn = normRu(q);
    if(nn){
      $$('.song-item').forEach(el=>{
        const tEl = el.querySelector('.song-title'), aEl = el.querySelector('.song-artist');
        const t = el.dataset.title, a = el.dataset.artist;
        const paint = src=>{
          const srcN = normRu(src); const i = srcN.indexOf(nn);
          if(i<0) return src;
          return src.substring(0,i) + '<span class="highlight">'+ src.substring(i, i+q.length) +'</span>' + src.substring(i+q.length);
        };
        tEl.innerHTML = paint(t); aEl.innerHTML = paint(a);
      });
    }

    sentinel.classList.toggle('hidden', visibleLimit>=filteredCache.length);
    revealObserve();
  }

  const loadObserver = new IntersectionObserver((entries)=>{
    entries.forEach(e=>{
      if(e.isIntersecting && visibleLimit < filteredCache.length){
        const next = Math.min(visibleLimit + BATCH, filteredCache.length);
        renderChunk(visibleLimit, next);
        visibleLimit = next;
        shownCountEl.textContent = visibleLimit;
        sentinel.classList.toggle('hidden', visibleLimit>=filteredCache.length);
        revealObserve();
      }
    });
  },{root:null,threshold:0.01});
  loadObserver.observe(sentinel);

  // ARTISTS chips
  const ARTISTS = (()=> {
    const set = new Set();
    ALL_SONGS.forEach(s=>s.artists.forEach(a=>set.add(a)));
    return Array.from(set).sort((a,b)=>{
      const aC = /^[а-яё]/i.test(a), bC = /^[а-яё]/i.test(b);
      if(aC!==bC) return aC? -1 : 1;
      return a.toLocaleLowerCase('ru').localeCompare(b.toLocaleLowerCase('ru'),'ru');
    });
  })();

  function renderArtistChips(filterText=''){
    artistChips.innerHTML = '';
    const needle = normRu(filterText);
    let list = ARTISTS.filter(a => !needle || normRu(a).includes(needle));

    artistMeta.textContent = `Всего исполнителей: ${ARTISTS.length}${needle ? ` • найдено: ${list.length}`:''}`;

    list.forEach(name=>{
      const btn = document.createElement('button');
      btn.className = 'chip';
      btn.textContent = name;
      btn.setAttribute('title', `Показать песни: ${name}`);
      if(name === artistFilter) btn.classList.add('active');
      btn.addEventListener('click', ()=>{
        artistFilter = (artistFilter === name) ? '' : name;
        $$('.chip', artistChips).forEach(c=>c.classList.remove('active'));
        if(artistFilter){ btn.classList.add('active'); showNote(`Фильтр: ${artistFilter}`); }
        else{ showNote('Фильтр исполнителя сброшен'); }
        renderSongs();
        document.getElementById('song-list').scrollIntoView({behavior:'smooth', block:'start'});
      });
      artistChips.appendChild(btn);
    });
  }

  // CART
  function toggleSelect(el){
    const key = `${el.dataset.title}::${el.dataset.artist}`;
    if(selected.has(key)){ selected.delete(key); el.classList.remove('selected'); }
    else{ selected.set(key, {title: el.dataset.title, artist: el.dataset.artist}); el.classList.add('selected'); }
    renderCart();
    const slot = el.querySelector('.absolute.right-2.top-2');
    slot.innerHTML = selected.has(key) ? '<i class="fa-solid fa-check text-emerald-400"></i>' : '';
  }

  function renderCart(){
    cartList.innerHTML = '';
    const arr = Array.from(selected.values());
    cartCount.textContent = arr.length;
    cartSection.classList.toggle('hidden', arr.length===0);
    toCartFloating.classList.toggle('show', arr.length>0);
    floatBadge.textContent = arr.length;
    floatBadge.classList.toggle('hidden', arr.length===0);

    arr.forEach(({title,artist})=>{
      const row = document.createElement('div');
      row.className = 'glass p-3 rounded-xl flex items-center justify-between border border-slate-700/40';
      row.innerHTML = `
        <div class="pr-3 min-w-0">
          <div class="font-semibold">${title}</div>
          <div class="text-sm opacity-80">${artist}</div>
        </div>
        <button class="btn btn-danger px-3 py-2"><i class="fa-solid fa-xmark"></i></button>`;
      row.querySelector('button').addEventListener('click', ()=>{
        selected.delete(`${title}::${artist}`);
        $$('.song-item').forEach(el=>{
          if(el.dataset.title===title && el.dataset.artist===artist) el.classList.remove('selected');
        });
        renderCart();
      });
      cartList.appendChild(row);
    });
  }

  function showNote(text){
    notify.querySelector('span').textContent = text;
    notify.classList.add('show');
    setTimeout(()=>notify.classList.remove('show'), 1600);
  }

  // SEARCH
  searchInput.addEventListener('input', ()=>{
    q = searchInput.value;
    clearSearch.classList.toggle('hidden', !q.length);
    renderSongs();
  });
  clearSearch.addEventListener('click', ()=>{
    searchInput.value=''; q='';
    clearSearch.classList.add('hidden'); renderSongs();
  });

  // ARTIST SEARCH
  artistSearch.addEventListener('input', ()=>{
    const v = artistSearch.value;
    artistSearchClear.classList.toggle('hidden', !v.length);
    renderArtistChips(v);
  });
  artistSearchClear.addEventListener('click', ()=>{
    artistSearch.value=''; artistSearchClear.classList.add('hidden'); renderArtistChips('');
  });
  artistClear.addEventListener('click', ()=>{
    artistFilter = '';
    artistSearch.value = ''; artistSearchClear.classList.add('hidden');
    renderArtistChips('');
    renderSongs();
  });

  // swipe scroll chips (desktop drag)
  (()=>{
    let isDown=false,startX,scrollLeft;
    artistChips.addEventListener('mousedown',e=>{isDown=true;startX=e.pageX-artistChips.offsetLeft;scrollLeft=artistChips.scrollLeft;artistChips.style.cursor='grabbing';});
    artistChips.addEventListener('mouseleave',()=>{isDown=false;artistChips.style.cursor='auto';});
    artistChips.addEventListener('mouseup',()=>{isDown=false;artistChips.style.cursor='auto';});
    artistChips.addEventListener('mousemove',e=>{if(!isDown)return;e.preventDefault();const x=e.pageX-artistChips.offsetLeft;const walk=(x-startX);artistChips.scrollLeft=scrollLeft-walk;});
  })();

  // CART BUTTONS
  $('#copyBtn').addEventListener('click', async ()=>{
    const text = Array.from(selected.values()).map(s=>`${s.title} — ${s.artist}`).join('\n');
    if(!text){ showNote('Список пуст'); return; }
    try{ await navigator.clipboard.writeText(text); showNote('Скопировано в буфер'); }
    catch(e){ showNote('Не удалось скопировать'); }
  });
  $('#clearBtn').addEventListener('click', ()=>{
    selected.clear(); $$('.song-item').forEach(el=>el.classList.remove('selected'));
    renderCart(); renderSongs(); showNote('Список очищен');
  });
  toCartFloating.addEventListener('click', ()=>{
    document.getElementById('cartSection').scrollIntoView({behavior:'smooth', block:'start'});
  });

  // Back to top + scroll progress
  window.addEventListener('scroll', ()=>{
    const y = window.scrollY || document.documentElement.scrollTop;
    toTopBtn.classList.toggle('show', y>600);
    const doc = document.documentElement;
    const max = doc.scrollHeight - doc.clientHeight;
    const progress = max>0 ? (y/max)*100 : 0;
    $('#scrollProgress').style.width = progress + '%';
  });
  toTopBtn.addEventListener('click', ()=>window.scrollTo({top:0,behavior:'smooth'}));

  // TG submit
  $('#orderForm').addEventListener('submit', async (e)=>{
    e.preventDefault();
    const arr = Array.from(selected.values());
    if(arr.length===0){ showNote('Добавьте песни в корзину'); return; }
    const name = $('#buyerName').value.trim();
    const contact = $('#buyerContact').value.trim();
    const comment = $('#buyerComment').value.trim();
    if(!name || !contact){ showNote('Укажите имя и контакт'); return; }

    const list = arr.map((s,i)=> `${i+1}. ${s.title} — ${s.artist}`).join('\n');
    const text =
`<b>Новая заявка на покупку песен</b>
👤 Имя: ${name}
📨 Контакт: ${contact}
💬 Комментарий: ${comment || '—'}

<b>Список (${arr.length}):</b>
${list}`;

    try{
      const res = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({chat_id: CHAT_ID, text, parse_mode:'HTML'})
      });
      if(!res.ok) throw new Error('TG error');
      showNote('Заявка отправлена!');
    }catch(err){
      const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${encodeURIComponent(CHAT_ID)}&parse_mode=HTML&text=${encodeURIComponent(text)}`;
      window.open(url,'_blank');
      showNote('Открыли Telegram для отправки');
    }
  });

  // reveal animations
  let io;
  function revealObserve(){
    if(io) io.disconnect();
    io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting){
          e.target.classList.add('in');
          io.unobserve(e.target);
        }
      });
    },{threshold:0.06});
    $$('.reveal', songList).forEach(el=>io.observe(el));
  }

  // INIT
  renderArtistChips('');
  renderSongs();
  </script>
</body>
</html>
